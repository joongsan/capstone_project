var dctk=window.dctk=window.dctk||{};dctk.logging=dctk.logging||{};(function(){if(dctk.logging._loaded||dctk._loggingLoaded){setTimeout(function(){throw new Error("Client Logging was attempted to be loaded twice")});return}dctk.logging._loaded=true;(function(){if(dctk.logging.enabled==null){dctk.logging.enabled=true}if(!dctk.logging.enabled){return}var o="/cl/1x1.gif",x="/cl/2x2.gif",G=[];var m=[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}];var f=[{string:navigator.userAgent,subString:"iPad",identity:"iPad"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"Kindle",identity:"Kindle"},{string:navigator.userAgent,subString:"BB10",identity:"Blackberry"},{string:navigator.userAgent,subString:"Touch",addlString:"MSIE 10",identity:"Surface"},{string:navigator.userAgent,subString:"Android",identity:"Android"},{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}];var s;dctk.logging.setProduction=function(i){s=i};dctk.logging._isProduction=function(){return s!=null?s:dctk.logging._isAProductionDomain()};var u=["www.expedia.com","www.expedia.co.uk","www.expedia.ca","www.expedia.de","www.expedia.it","www.expedia.es","www.expedia.nl","www.expedia.mx","www.expedia.com.sg","www.expedia.com.my","www.expedia.co.kr","www.expedia.co.th","www.expedia.com.hk","www.expedia.fr","www.expedia.com.au","www.expedia.co.in","www.expedia.co.jp","www.expedia.co.nz","www.expedia.co.id","www.expedia.com.tw","www.expedia.ie","www.expedia.be","www.expedia.se","www.expedia.no","www.expedia.dk","www.expedia.com.ph","www.expedia.com.br","www.expedia.com.ar","www.expedia.com.vn","www.expedia.fi","www.expedia.at","expedia.viaggi.virgilio.it","expedia.viaggi.tiscali.it","expedia.corriere.it","expedia.viaggi.deejay.it","expedia.allmusic.tv","voyages.anyway.com","yahoo.expedia.com.au","ninemsn.expedia.com.au","jal.expedia.co.jp","msn.expedia.co.jp","expedia-aarp.com","voyage-sncf.com","expediafortd.com","vacation.hotwire.com","www.travelocity.com","www.travelocity.ca","xsell.expedia.com","www.airasiago.com.my","orbitz.com",/(^|\.)wotif\.(com|co\.nz)$/];dctk.logging._isAProductionDomain=function(L){L=L||{};L._domain=L._domain||J;L._productionDomains=L._productionDomains||u;for(var K=0;K<L._productionDomains.length;K++){if(L._domain.match(L._productionDomains[K])){return true}}return false};var q=function(N){for(var K=0;K<N.length;K++){var L=N[K].string;var M=N[K].prop;dctk.logging.versionSearchString=N[K].versionSearch||N[K].identity;if(L){if(L.indexOf(N[K].subString)!=-1&&(!N[K].addlString||L.indexOf(N[K].addlString)!=-1)){return N[K].identity||"unknown"}}else{if(M){return N[K].identity||"unknown"}}}};var v=function(K){var i=K.indexOf(dctk.logging.versionSearchString);if(i==-1){return}return parseFloat(K.substring(i+dctk.logging.versionSearchString.length+1))};var n=function(i){if(i.toISOString){return i.toISOString()}else{return i.getFullYear().toString()+"-"+i.getMonth()+"-"+i.getDate()+"T"+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds()}};var y=function(L,K,i){if(L.attachEvent){L["e"+K+i]=i;L[K+i]=function(){L["e"+K+i](window.event)};L.attachEvent("on"+K,L[K+i])}else{L.addEventListener(K,i,false)}};var E=function(i){p(o+d+"&pageName="+dctk.logging.pageName+"&guid="+k()+"&logTime="+n(new Date())+"&sessionDuration="+encodeURIComponent(c())+"&action=logTrxEvent&"+(i||[]).join("&"))};var k=function(){return dctk.logging.guid||"unknown"};var w=function(i){return window.performance&&performance.timing&&performance.timing[i]||NaN};var H=q(m);var l=v(navigator.userAgent)||v(navigator.appVersion)||"an unknown version";var J=window.location.hostname;var e=q(f);var a="";if(dctk.logging.data){for(var A=0,r=dctk.logging.data.split("|");A<r.length&&r[A].length>0;A++){a+="&"+r[A]}}var d="?browser="+H+"&browserVersion="+l+"&platform="+e+"&domain="+J+"&live="+dctk.logging._isProduction()+a;if("performance" in window){dctk.logging.pageStartTime=window.performance.timing.responseStart}else{dctk.logging.pageStartTime=dctk.logging.pageStartTime||new Date().getTime()}var b=function(i){if(document.readyState=="complete"){i()}else{y(window,"load",i)}};var F=function(i){b(function(){i({unloadTime:w("unloadEventEnd")-w("unloadEventStart"),redirectTime:w("redirectEnd")-w("redirectStart"),dnsTime:w("domainLookupEnd")-w("domainLookupStart"),connectionTime:w("connectEnd")-w("connectStart"),requestTime:w("responseStart")-w("requestStart"),responseTime:w("responseEnd")-w("responseStart"),parsingTime:w("domInteractive")-w("domLoading"),domReadyCallbackTime:w("domContentLoadedEventEnd")-w("domContentLoadedEventStart"),onLdCallbackTime:w("loadEventEnd")-w("loadEventStart"),processingTime:w("domComplete")-w("domLoading"),navigationToResponse:w("responseStart")-w("navigationStart"),navigationToDomContentLoaded:w("domContentLoadedEventStart")-w("navigationStart"),navigationToOnLd:w("loadEventStart")-w("navigationStart"),fetchToResponse:w("responseStart")-w("fetchStart"),fetchToDomContentLoaded:w("domContentLoadedEventStart")-w("fetchStart"),fetchToOnLd:w("loadEventStart")-w("fetchStart"),responseToDomContentLoaded:w("domContentLoadedEventStart")-w("responseStart"),responseToOnLd:w("loadEventStart")-w("responseStart"),navigationToDomInteractive:w("domInteractive")-w("navigationStart")})})};dctk.logging.navTiming={};dctk.logging.browser=H;dctk.logging.version=l;dctk.logging.OS=e;dctk.logging.logTrxEvent=function(i,K){var L=[i+"_elapsedTime="+(new Date().getTime()-dctk.logging.pageStartTime)];if(K){L=L.concat(dctk.logging._normalizeMessageParams(K))}E(L)};dctk.logging.trxEventWrapper=function(L,i,K){return function(){var O=new Date().getTime();var M=L.apply((K?K:dctk.logging),arguments);var N=new Date().getTime();E([i+"_elapsedTime="+(N-dctk.logging.pageStartTime),"clEventName01="+i,"clEventTime01="+(N-O)]);return M}};dctk.logging.logMessage=function(i,K){var L=dctk.logging._normalizeMessageParams((function(){var M={logTime:n(new Date),action:"logErrors",label:i,pageName:dctk.logging.pageName,pageUrl:window.location.href,guid:k(),clientWidth:document.documentElement.clientWidth};M[i+"_elapsedTime"]=new Date().getTime()-dctk.logging.pageStartTime;return M})());L=L.concat(dctk.logging._normalizeMessageParams(K));p(x+d+"&"+L.join("&"))};dctk.logging.logError=function(L,K,i){var M=dctk.logging._normalizeMessageParams(K?I(K):{onError:"NA"});M=M.concat(dctk.logging._normalizeMessageParams(i));dctk.logging.logMessage(L,M);D(L+"\n"+M.join("\n"))};dctk.logging.reset=function(){dctk.logging.pageStartTime=new Date().getTime()};dctk.logging.subscribeToOnerrorCallback=function(i){G.push(i)};dctk.logging.publishOnerrorCallback=function(){for(var K=0;K<G.length;K++){if(typeof G[K]==="function"){G[K]()}}};dctk.logging.setPageName=function(i){dctk.logging.pageName=i};var j=window.onerror;var C={};dctk.logging._onerror=function(O,L,i,N,K){var Q=K?I(K):{onErrorMsg:O};Q.onErrorUrl=L;Q.onErrorLine=i;Q.onErrorChar=N==null?"NA":N;C[O]=(C[O]||0)+1;var P=C[O]==100;if(P){Q.exceedsErrorThreshold="true"}var M=C[O]==1||P;if(M){dctk.logging.logMessage("windowOnError",Q)}dctk.logging.publishOnerrorCallback()};window.onerror=function(){try{if(j){j.apply(window,arguments)}}finally{dctk.logging._onerror.apply(dctk.logging,arguments)}};dctk.loggingAdapter=dctk.logging;dctk.logging._normalizeMessageParams=function(K){if(!K){return[]}if(typeof K=="string"){return[K]}if(!(K instanceof Array)){var L=[];for(var i in K){L.push(encodeURIComponent(i)+"="+encodeURIComponent(B(K[i])))}K=L}return K};var B=function(i){return'"'+String(i).replace(/"/g,"ï¼‚")+'"'};var D=function(i){try{console.error(i)}catch(L){try{console.log(i)}catch(K){}}};dctk.logging._beaconImages=[];var p=function(i){var K=new Image;K.src=i;dctk.logging._beaconImages.push(K)};var I=function(i){i=t(i);return{onErrorMsg:i.message,onErrorUrl:i.sourceURL,onErrorLine:i.line,onErrorChar:i.col,stack:i.stack?i.stack.substr(0,200):"NA"}};var t=function(N){var K="NA",L=K,i=K,P=K,O;try{if(N&&N.stack){O=N.stack.match(/\(([^\)]+\d+)\)/);if(!O){O=N.stack.match(/@([^\)]+\d+)\n/)}if(O){O=O[1].split(":");L=O.pop();i=O.pop();P=O.join(":")}}}catch(M){}if(N){N={sourceURL:N.sourceURL||N.fileName||P,line:N.line||N.lineNumber||i,col:N.columnNumber||L,message:N.message,stack:N.stack||K}}return N};var c=function(){var i,M,Q,N,L,O,P;M=new Date().getTime();try{if(!window.localStorage){return}Q="dctk_clientLogging_firstInteractionTimestamp";N="dctk_clientLogging_lastInteractionTimestamp";L=Number(localStorage.getItem(N));i=Number(localStorage.getItem(Q));O=M-L>30*60*1000;P=i===0;if(O||P){i=M;localStorage.setItem(Q,i)}L=M;localStorage.setItem(N,L)}catch(K){i=M}return M-i};var z=function(K){var M=[];for(var i in K){var L=K[i];if(L==null||isNaN(L)){continue}M.push(encodeURIComponent(i)+"="+encodeURIComponent(L))}return M.join("&")};(function h(){F(function(i){dctk.logging.navTiming=i;dctk.logging.logTrxEvent("navTiming",z(i))})})();(function g(){setInterval(E,1*60*1000)})()})();if(typeof define=="function"&&define.amd){define("dctk/clientLogging",function(){return dctk.logging})}})();